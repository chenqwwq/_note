# 分布式系统唯一 ID 生成算法



---

[TOC]

---







## Snowflake（雪花算法）



Snowflake 是 Twitter 开源的算法之一。

该算法的产出是 long 类型的 Id，一共有 64 bit，其核心思想是：**使用41bit作为毫秒数，10bit作为机器的ID（5个bit是数据中心，5个bit的机器ID），12bit作为毫秒内的流水号（意味着每个节点在每毫秒可以产生 4096 个 ID），最后还有一个符号位，永远是0。**



## 数据库自增主键

使用数据库自增主键在插入时获取唯一 Id，可以完全保证其唯一性以及有序性，并且实现上简单，易于接受。

考虑到插入问题，可以对数据库进行分表分库，划分自增的起始 ID 结合相同或者不同的步长。

> 例如，分表之后 Id_1 表从0开始递增，Id_2 表从 10000 开始递增，对于少量唯一分配可以接受。
>
> 又或者 Id_1 表从0开始，Id_2 表从1开始，步长为2，可以一直分配下去。





## UUID

Java 中直接使用如下代码生成：

```java
UUID.randomUUID().toString();
```

创建的 UUID 如下：92d31750-31ac-4a49-ae70-1350806a824f

UUID 生成非常简单，并且可以保证全球唯一（生成时参考了本地时间戳，MAC 地址等因素。

但是无法保证其有序或者递增，并且生成的长字符串可读性非常差，占用空间相对来说也略多。

