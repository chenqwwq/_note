## MESI协议



MESI是一种缓存行的一致性协议。

协议将缓存行分为四种状态:

- M - 已修改
- E - 独占
- S - 共享
- I - 过期

采用四种状态的形式来避免之前的锁总线等一些高消耗的技术实现。

## 缓存行的伪共享

根据程序的局部性原理，每次读取数据之后可能会短时间之内再用到附近的数据，所以缓存行每次的加载都会顺带缓存附近的数据。

在多核CPU中，如果共同读取一段相近的数据，将同段数据分别读取到各自的缓存行中，那么在一个CPU修改之后，另外的缓存行都会失效，那么每次读取都会从内存中再次读取，如果更新的频繁，相当于缓存行直接失效。